#----------------------------------------------------------------------------------------------
#This code counts the number of variants inside my vcfs. This includes total variant numbers and per chromosome variant count
#----------------------------------------------------------------------------------------------
#!/bin/bash
#SBATCH --job-name=vcf_variant_counts
#SBATCH --output=vcf_variant_counts.out
#SBATCH --error=vcf_variant_counts.err
#SBATCH --time=01:00:00
#SBATCH --mem=80G
#SBATCH --cpus-per-task=1
#SBATCH --partition=parallel
#SBATCH --account=m2_jgu-salmosex
#SBATCH -C skylake
# Load bcftools module
module load bio/BCFtools/1.14-GCC-11.2.0

# Path to VCF file
VCF="/lustre/miifs01/project/m2_jgu-salmosex/nina/data/filtered_data/all_BioProjects_combined_org/variantvalling/merged_vcf_wo_missing.vcf.gz"

# Output files
OUT_DIR=$(dirname "$VCF")
CHROM_COUNTS="$OUT_DIR/variant_counts_per_chrom_wo_miss.txt"
TOTAL_COUNT="$OUT_DIR/total_variant_count_wo_miss.txt"

echo "Counting variants per chromosome..."
bcftools query -f '%CHROM\n' "$VCF" | sort | uniq -c | sort -k2 > "$CHROM_COUNTS"

echo "Counting total number of variants..."
bcftools view -H "$VCF" | wc -l > "$TOTAL_COUNT"

echo "Done."


#--------------------------------------------------------
#This script uses VCFtools to analyze a VCF file and generate two reports: one showing the proportion of missing genotypes for each individual sample, 
#and another showing the proportion of missing data at each variant site
#--------------------------------------------------------

#!/bin/bash
#SBATCH --job-name=vcftools_missing
#SBATCH --partition=smp
#SBATCH --account=m2_jgu-salmosex
#SBATCH --time=1-00:00:00
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=4
#SBATCH -o missing.out
#SBATCH -e missing.err

# Load the required module
module load bio/VCFtools/0.1.16-GCC-11.2.0

# Change to the working directory
cd /lustre/miifs01/project/m2_jgu-salmosex/nina/data/filtered_data/all_BioProjects_combined_org/variantvalling/filtered_variants/vcf_strict/vca/

# Run VCFtools to calculate missing individual data
vcftools --gzvcf /lustre/miifs01/project/m2_jgu-salmosex/nina/data/filtered_data/all_BioProjects_combined_org/variantvalling/filtered_variants/vcf_strict/filtered_variants.vcf.gz --missing-indv --out missing_indiv

# Run VCFtools to calculate missing site data
vcftools --gzvcf /lustre/miifs01/project/m2_jgu-salmosex/nina/data/filtered_data/all_BioProjects_combined_org/variantvalling/filtered_variants/vcf_strict/filtered_variants.vcf.gz --missing-site --out missing_site

